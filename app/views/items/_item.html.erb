<% detail_div_id = "item_detail#{item.id}" %>
<li id="item-<%= item.id %>"
  class="list-group-item list-group-item-action pb-4">
  <div class="d-flex w-100 clickable">
    <div>
      <a
        id="item_details_header_<%= item.id %>%"
        href="#<%= detail_div_id %>"
        data-toggle="collapse" role="button" 
        aria-expanded="false" aria-controls="Item Orders Details">
        <h5 class="mb-1"><%= item.title %></h5>
      </a>
    </div>
    <div class="align-self-top ml-auto no-wrap">
      <% if @admin %>
        <small class="ml-2 no-wrap"><%= link_to t('.new_subitem'), new_item_path(item: item.id), remote: true %></small>
        <small class="mx-1">|</small>
        <small class="mr-2 no-wrap"><%= link_to t('.new_source'), new_source_path(item: item.id), remote: true %></small>
      <% end %>
      <span class="badge badge-primary badge-pill"><%= item.items.actives.count %></span>
      <div class="btn-group btn-group-sm ml-2" role="group" aria-label="Controls of Theme">
        <% if @admin %>
          <%= link_to edit_item_path(item),
            remote: true, 
            title: t('.edit'),
            class: "btn btn-light" do %>
            <%= fa_icon 'pencil' %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <p class="mb-1 clickable"><%= item.description %></p>
  <div class="collapse pt-1" id="<%= detail_div_id %>">
    <div class="card card-body">
      <ul class="sources-list">
        <% item.sources.each do |source| %>
          <%= render partial: 'sources/source', locals: { source: source, item: item } %>
        <% end %>
      </ul>
      <% if item.items.any? %>
        <div class="w-100 border-bottom my-2"></div>
      <% end %>
      <ul class="list-group list-group-flush subitems-list">
        <% item.items.each do |subitem| %>
          <%= render partial: 'subitem', locals: { subitem: subitem } %>
        <% end %>
      </ul>
    </div>
  </div>
</li>